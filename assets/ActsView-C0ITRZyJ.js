import{E as be,_ as de,c as M,a as f,n as j,w as K,F as N,r as Q,b as F,t as O,d as U,e as Y,f as Ee,o as x,g as ie,A as Ie,v as Se,h as oe}from"./index-Sxu-8l9n.js";function ke(t){return(new DOMParser().parseFromString(t,"text/html").body.textContent||"").trim()}const Ae={props:{event:{type:Object,required:!0}},methods:{removeHTMLTags(t){return ke(t)},openDialog(){this.$router.push({query:{details:this.event.data.uid}})},toggleSuggested(){var t,e;if(this.$ctx.currentUser.value===void 0){this.openLoginNeededDialog.value=!0;return}(e=(t=this.$client.space)==null?void 0:t.self)==null||e.toggleSuggested(this.event.data.uid)},toggleLike(){var t,e;if(this.$ctx.currentUser.value===void 0){this.openLoginNeededDialog.value=!0;return}(e=(t=this.$client.space)==null?void 0:t.self)==null||e.toggleLike(this.event.data.uid)}},components:{EventDetailsChips:be}},Ce={class:"absolute top right right padding white-text",style:{"z-index":"10"}},Te={class:"responsive large"},Le={key:0,class:"absolute bottom left padding white-text rounded",style:{"z-index":"10","max-width":"50%",overflow:"hidden"}},Re={class:"blur small-padding",style:{display:"flex","flex-direction":"row","flex-wrap":"nowrap",overflow:"hidden"}},$e={key:1,class:"absolute bottom right padding white-text rounded",style:{"z-index":"10","max-width":"50%",overflow:"hidden"}},Ne={class:"blur small-padding",style:{display:"flex","flex-direction":"row","flex-wrap":"nowrap",overflow:"hidden"}},Oe={class:"padding",style:{"padding-bottom":"0 !important"}},Fe={style:{display:"block","text-overflow":"ellipsis","word-wrap":"break-word",overflow:"hidden","max-height":"3.6em","line-height":"1.2em"}},De={class:"padding"},je={style:{display:"block","text-overflow":"ellipsis","word-wrap":"break-word",overflow:"hidden","max-height":"5em","line-height":"1.8em"}};function Pe(t,e,s,r,n,i){var a,c,h,d,g,p,m,y;const o=Y("EventDetailsChips"),l=Ee("lazy");return s.event!=null?(x(),M("article",{key:0,class:j(["no-padding",{secondary:s.event.likerIds.length>0||s.event.suggestorIds.length>0}])},[f("div",Ce,[f("button",{class:"blur circle",onClick:e[0]||(e[0]=_=>i.toggleSuggested())},[f("i",{class:j({fill:(c=(a=t.$client.space)==null?void 0:a.self)==null?void 0:c.isSuggested(s.event.data.uid),"primary-text":(d=(h=t.$client.space)==null?void 0:h.self)==null?void 0:d.isSuggested(s.event.data.uid)})},"thumb_up",2)]),f("button",{class:"blur circle",onClick:e[1]||(e[1]=_=>i.toggleLike())},[f("i",{class:j({fill:(p=(g=t.$client.space)==null?void 0:g.self)==null?void 0:p.isLiked(s.event.data.uid),"primary-text":(y=(m=t.$client.space)==null?void 0:m.self)==null?void 0:y.isLiked(s.event.data.uid)})},"favorite",2)])]),f("div",{onClick:e[2]||(e[2]=_=>i.openDialog()),class:"wave wave-big",style:{cursor:"pointer"}},[f("div",null,[K(f("img",Te,null,512),[[l,{src:s.event.cardThumbnailUrl()}]]),s.event.suggestorIds.length>0?(x(),M("div",Le,[f("div",Re,[(x(!0),M(N,null,Q(s.event.suggestorIds,_=>{var v;return x(),M("i",{class:j(["fill",[`${(v=t.$client.container.spaceMemberById.get(_))==null?void 0:v.color}-text`]]),style:{scale:.7}}," thumb_up ",2)}),256))])])):F("",!0),s.event.likerIds.length>0?(x(),M("div",$e,[f("div",Ne,[(x(!0),M(N,null,Q(s.event.likerIds,_=>{var v;return x(),M("i",{class:j(["fill",[`${(v=t.$client.container.spaceMemberById.get(_))==null?void 0:v.color}-text`]]),style:{scale:.7}}," favorite ",2)}),256))])])):F("",!0)]),f("div",Oe,[f("h5",Fe,O(s.event.cardTitle()),1)]),U(o,{event:s.event},null,8,["event"]),f("div",De,[f("p",je,O(i.removeHTMLTags(s.event.cardDescription())),1)])])],2)):F("",!0)}const Be=de(Ae,[["render",Pe]]);function S(t){return Array.isArray?Array.isArray(t):pe(t)==="[object Array]"}const ze=1/0;function Ke(t){if(typeof t=="string")return t;let e=t+"";return e=="0"&&1/t==-ze?"-0":e}function Ve(t){return t==null?"":Ke(t)}function I(t){return typeof t=="string"}function fe(t){return typeof t=="number"}function We(t){return t===!0||t===!1||qe(t)&&pe(t)=="[object Boolean]"}function ge(t){return typeof t=="object"}function qe(t){return ge(t)&&t!==null}function w(t){return t!=null}function H(t){return!t.trim().length}function pe(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const He="Incorrect 'index' type",Qe=t=>`Invalid value for key ${t}`,Ue=t=>`Pattern length exceeds max of ${t}.`,Ye=t=>`Missing ${t} property in key`,Ge=t=>`Property 'weight' in key '${t}' must be a positive integer`,ce=Object.prototype.hasOwnProperty;class Xe{constructor(e){this._keys=[],this._keyMap={};let s=0;e.forEach(r=>{let n=me(r);this._keys.push(n),this._keyMap[n.id]=n,s+=n.weight}),this._keys.forEach(r=>{r.weight/=s})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function me(t){let e=null,s=null,r=null,n=1,i=null;if(I(t)||S(t))r=t,e=le(t),s=G(t);else{if(!ce.call(t,"name"))throw new Error(Ye("name"));const o=t.name;if(r=o,ce.call(t,"weight")&&(n=t.weight,n<=0))throw new Error(Ge(o));e=le(o),s=G(o),i=t.getFn}return{path:e,id:s,weight:n,src:r,getFn:i}}function le(t){return S(t)?t:t.split(".")}function G(t){return S(t)?t.join("."):t}function Je(t,e){let s=[],r=!1;const n=(i,o,l)=>{if(w(i))if(!o[l])s.push(i);else{let a=o[l];const c=i[a];if(!w(c))return;if(l===o.length-1&&(I(c)||fe(c)||We(c)))s.push(Ve(c));else if(S(c)){r=!0;for(let h=0,d=c.length;h<d;h+=1)n(c[h],o,l+1)}else o.length&&n(c,o,l+1)}};return n(t,I(e)?e.split("."):e,0),r?s:s[0]}const Ze={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},et={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1},tt={location:0,threshold:.6,distance:100},st={useExtendedSearch:!1,getFn:Je,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var u={...et,...Ze,...tt,...st};const nt=/[^ ]+/g;function rt(t=1,e=3){const s=new Map,r=Math.pow(10,e);return{get(n){const i=n.match(nt).length;if(s.has(i))return s.get(i);const o=1/Math.pow(i,.5*t),l=parseFloat(Math.round(o*r)/r);return s.set(i,l),l},clear(){s.clear()}}}class se{constructor({getFn:e=u.getFn,fieldNormWeight:s=u.fieldNormWeight}={}){this.norm=rt(s,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((s,r)=>{this._keysMap[s.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,I(this.docs[0])?this.docs.forEach((e,s)=>{this._addString(e,s)}):this.docs.forEach((e,s)=>{this._addObject(e,s)}),this.norm.clear())}add(e){const s=this.size();I(e)?this._addString(e,s):this._addObject(e,s)}removeAt(e){this.records.splice(e,1);for(let s=e,r=this.size();s<r;s+=1)this.records[s].i-=1}getValueForItemAtKeyId(e,s){return e[this._keysMap[s]]}size(){return this.records.length}_addString(e,s){if(!w(e)||H(e))return;let r={v:e,i:s,n:this.norm.get(e)};this.records.push(r)}_addObject(e,s){let r={i:s,$:{}};this.keys.forEach((n,i)=>{let o=n.getFn?n.getFn(e):this.getFn(e,n.path);if(w(o)){if(S(o)){let l=[];const a=[{nestedArrIndex:-1,value:o}];for(;a.length;){const{nestedArrIndex:c,value:h}=a.pop();if(w(h))if(I(h)&&!H(h)){let d={v:h,i:c,n:this.norm.get(h)};l.push(d)}else S(h)&&h.forEach((d,g)=>{a.push({nestedArrIndex:g,value:d})})}r.$[i]=l}else if(I(o)&&!H(o)){let l={v:o,n:this.norm.get(o)};r.$[i]=l}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}}function ye(t,e,{getFn:s=u.getFn,fieldNormWeight:r=u.fieldNormWeight}={}){const n=new se({getFn:s,fieldNormWeight:r});return n.setKeys(t.map(me)),n.setSources(e),n.create(),n}function it(t,{getFn:e=u.getFn,fieldNormWeight:s=u.fieldNormWeight}={}){const{keys:r,records:n}=t,i=new se({getFn:e,fieldNormWeight:s});return i.setKeys(r),i.setIndexRecords(n),i}function z(t,{errors:e=0,currentLocation:s=0,expectedLocation:r=0,distance:n=u.distance,ignoreLocation:i=u.ignoreLocation}={}){const o=e/t.length;if(i)return o;const l=Math.abs(r-s);return n?o+l/n:l?1:o}function ot(t=[],e=u.minMatchCharLength){let s=[],r=-1,n=-1,i=0;for(let o=t.length;i<o;i+=1){let l=t[i];l&&r===-1?r=i:!l&&r!==-1&&(n=i-1,n-r+1>=e&&s.push([r,n]),r=-1)}return t[i-1]&&i-r>=e&&s.push([r,i-1]),s}const L=32;function ct(t,e,s,{location:r=u.location,distance:n=u.distance,threshold:i=u.threshold,findAllMatches:o=u.findAllMatches,minMatchCharLength:l=u.minMatchCharLength,includeMatches:a=u.includeMatches,ignoreLocation:c=u.ignoreLocation}={}){if(e.length>L)throw new Error(Ue(L));const h=e.length,d=t.length,g=Math.max(0,Math.min(r,d));let p=i,m=g;const y=l>1||a,_=y?Array(d):[];let v;for(;(v=t.indexOf(e,m))>-1;){let b=z(e,{currentLocation:v,expectedLocation:g,distance:n,ignoreLocation:c});if(p=Math.min(b,p),m=v+h,y){let k=0;for(;k<h;)_[v+k]=1,k+=1}}m=-1;let R=[],T=1,P=h+d;const we=1<<h-1;for(let b=0;b<h;b+=1){let k=0,A=P;for(;k<A;)z(e,{errors:b,currentLocation:g+A,expectedLocation:g,distance:n,ignoreLocation:c})<=p?k=A:P=A,A=Math.floor((P-k)/2+k);P=A;let ne=Math.max(1,g-A+1),q=o?d:Math.min(g+A,d)+h,$=Array(q+2);$[q+1]=(1<<b)-1;for(let E=q;E>=ne;E-=1){let B=E-1,re=s[t.charAt(B)];if(y&&(_[B]=+!!re),$[E]=($[E+1]<<1|1)&re,b&&($[E]|=(R[E+1]|R[E])<<1|1|R[E+1]),$[E]&we&&(T=z(e,{errors:b,currentLocation:B,expectedLocation:g,distance:n,ignoreLocation:c}),T<=p)){if(p=T,m=B,m<=g)break;ne=Math.max(1,2*g-m)}}if(z(e,{errors:b+1,currentLocation:g,expectedLocation:g,distance:n,ignoreLocation:c})>p)break;R=$}const W={isMatch:m>=0,score:Math.max(.001,T)};if(y){const b=ot(_,l);b.length?a&&(W.indices=b):W.isMatch=!1}return W}function lt(t){let e={};for(let s=0,r=t.length;s<r;s+=1){const n=t.charAt(s);e[n]=(e[n]||0)|1<<r-s-1}return e}class ve{constructor(e,{location:s=u.location,threshold:r=u.threshold,distance:n=u.distance,includeMatches:i=u.includeMatches,findAllMatches:o=u.findAllMatches,minMatchCharLength:l=u.minMatchCharLength,isCaseSensitive:a=u.isCaseSensitive,ignoreLocation:c=u.ignoreLocation}={}){if(this.options={location:s,threshold:r,distance:n,includeMatches:i,findAllMatches:o,minMatchCharLength:l,isCaseSensitive:a,ignoreLocation:c},this.pattern=a?e:e.toLowerCase(),this.chunks=[],!this.pattern.length)return;const h=(g,p)=>{this.chunks.push({pattern:g,alphabet:lt(g),startIndex:p})},d=this.pattern.length;if(d>L){let g=0;const p=d%L,m=d-p;for(;g<m;)h(this.pattern.substr(g,L),g),g+=L;if(p){const y=d-L;h(this.pattern.substr(y),y)}}else h(this.pattern,0)}searchIn(e){const{isCaseSensitive:s,includeMatches:r}=this.options;if(s||(e=e.toLowerCase()),this.pattern===e){let m={isMatch:!0,score:0};return r&&(m.indices=[[0,e.length-1]]),m}const{location:n,distance:i,threshold:o,findAllMatches:l,minMatchCharLength:a,ignoreLocation:c}=this.options;let h=[],d=0,g=!1;this.chunks.forEach(({pattern:m,alphabet:y,startIndex:_})=>{const{isMatch:v,score:R,indices:T}=ct(e,m,y,{location:n+_,distance:i,threshold:o,findAllMatches:l,minMatchCharLength:a,includeMatches:r,ignoreLocation:c});v&&(g=!0),d+=R,v&&T&&(h=[...h,...T])});let p={isMatch:g,score:g?d/this.chunks.length:1};return g&&r&&(p.indices=h),p}}class C{constructor(e){this.pattern=e}static isMultiMatch(e){return ae(e,this.multiRegex)}static isSingleMatch(e){return ae(e,this.singleRegex)}search(){}}function ae(t,e){const s=t.match(e);return s?s[1]:null}class at extends C{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const s=e===this.pattern;return{isMatch:s,score:s?0:1,indices:[0,this.pattern.length-1]}}}class ht extends C{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const r=e.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,e.length-1]}}}class ut extends C{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const s=e.startsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,this.pattern.length-1]}}}class dt extends C{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const s=!e.startsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,e.length-1]}}}class ft extends C{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const s=e.endsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class gt extends C{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const s=!e.endsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,e.length-1]}}}class _e extends C{constructor(e,{location:s=u.location,threshold:r=u.threshold,distance:n=u.distance,includeMatches:i=u.includeMatches,findAllMatches:o=u.findAllMatches,minMatchCharLength:l=u.minMatchCharLength,isCaseSensitive:a=u.isCaseSensitive,ignoreLocation:c=u.ignoreLocation}={}){super(e),this._bitapSearch=new ve(e,{location:s,threshold:r,distance:n,includeMatches:i,findAllMatches:o,minMatchCharLength:l,isCaseSensitive:a,ignoreLocation:c})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class Me extends C{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let s=0,r;const n=[],i=this.pattern.length;for(;(r=e.indexOf(this.pattern,s))>-1;)s=r+i,n.push([r,s-1]);const o=!!n.length;return{isMatch:o,score:o?0:1,indices:n}}}const X=[at,Me,ut,dt,gt,ft,ht,_e],he=X.length,pt=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,mt="|";function yt(t,e={}){return t.split(mt).map(s=>{let r=s.trim().split(pt).filter(i=>i&&!!i.trim()),n=[];for(let i=0,o=r.length;i<o;i+=1){const l=r[i];let a=!1,c=-1;for(;!a&&++c<he;){const h=X[c];let d=h.isMultiMatch(l);d&&(n.push(new h(d,e)),a=!0)}if(!a)for(c=-1;++c<he;){const h=X[c];let d=h.isSingleMatch(l);if(d){n.push(new h(d,e));break}}}return n})}const vt=new Set([_e.type,Me.type]);class _t{constructor(e,{isCaseSensitive:s=u.isCaseSensitive,includeMatches:r=u.includeMatches,minMatchCharLength:n=u.minMatchCharLength,ignoreLocation:i=u.ignoreLocation,findAllMatches:o=u.findAllMatches,location:l=u.location,threshold:a=u.threshold,distance:c=u.distance}={}){this.query=null,this.options={isCaseSensitive:s,includeMatches:r,minMatchCharLength:n,findAllMatches:o,ignoreLocation:i,location:l,threshold:a,distance:c},this.pattern=s?e:e.toLowerCase(),this.query=yt(this.pattern,this.options)}static condition(e,s){return s.useExtendedSearch}searchIn(e){const s=this.query;if(!s)return{isMatch:!1,score:1};const{includeMatches:r,isCaseSensitive:n}=this.options;e=n?e:e.toLowerCase();let i=0,o=[],l=0;for(let a=0,c=s.length;a<c;a+=1){const h=s[a];o.length=0,i=0;for(let d=0,g=h.length;d<g;d+=1){const p=h[d],{isMatch:m,indices:y,score:_}=p.search(e);if(m){if(i+=1,l+=_,r){const v=p.constructor.type;vt.has(v)?o=[...o,...y]:o.push(y)}}else{l=0,i=0,o.length=0;break}}if(i){let d={isMatch:!0,score:l/i};return r&&(d.indices=o),d}}return{isMatch:!1,score:1}}}const J=[];function Mt(...t){J.push(...t)}function Z(t,e){for(let s=0,r=J.length;s<r;s+=1){let n=J[s];if(n.condition(t,e))return new n(t,e)}return new ve(t,e)}const V={AND:"$and",OR:"$or"},ee={PATH:"$path",PATTERN:"$val"},te=t=>!!(t[V.AND]||t[V.OR]),xt=t=>!!t[ee.PATH],wt=t=>!S(t)&&ge(t)&&!te(t),ue=t=>({[V.AND]:Object.keys(t).map(e=>({[e]:t[e]}))});function xe(t,e,{auto:s=!0}={}){const r=n=>{let i=Object.keys(n);const o=xt(n);if(!o&&i.length>1&&!te(n))return r(ue(n));if(wt(n)){const a=o?n[ee.PATH]:i[0],c=o?n[ee.PATTERN]:n[a];if(!I(c))throw new Error(Qe(a));const h={keyId:G(a),pattern:c};return s&&(h.searcher=Z(c,e)),h}let l={children:[],operator:i[0]};return i.forEach(a=>{const c=n[a];S(c)&&c.forEach(h=>{l.children.push(r(h))})}),l};return te(t)||(t=ue(t)),r(t)}function bt(t,{ignoreFieldNorm:e=u.ignoreFieldNorm}){t.forEach(s=>{let r=1;s.matches.forEach(({key:n,norm:i,score:o})=>{const l=n?n.weight:null;r*=Math.pow(o===0&&l?Number.EPSILON:o,(l||1)*(e?1:i))}),s.score=r})}function Et(t,e){const s=t.matches;e.matches=[],w(s)&&s.forEach(r=>{if(!w(r.indices)||!r.indices.length)return;const{indices:n,value:i}=r;let o={indices:n,value:i};r.key&&(o.key=r.key.src),r.idx>-1&&(o.refIndex=r.idx),e.matches.push(o)})}function It(t,e){e.score=t.score}function St(t,e,{includeMatches:s=u.includeMatches,includeScore:r=u.includeScore}={}){const n=[];return s&&n.push(Et),r&&n.push(It),t.map(i=>{const{idx:o}=i,l={item:e[o],refIndex:o};return n.length&&n.forEach(a=>{a(i,l)}),l})}class D{constructor(e,s={},r){this.options={...u,...s},this.options.useExtendedSearch,this._keyStore=new Xe(this.options.keys),this.setCollection(e,r)}setCollection(e,s){if(this._docs=e,s&&!(s instanceof se))throw new Error(He);this._myIndex=s||ye(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){w(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const s=[];for(let r=0,n=this._docs.length;r<n;r+=1){const i=this._docs[r];e(i,r)&&(this.removeAt(r),r-=1,n-=1,s.push(i))}return s}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:s=-1}={}){const{includeMatches:r,includeScore:n,shouldSort:i,sortFn:o,ignoreFieldNorm:l}=this.options;let a=I(e)?I(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return bt(a,{ignoreFieldNorm:l}),i&&a.sort(o),fe(s)&&s>-1&&(a=a.slice(0,s)),St(a,this._docs,{includeMatches:r,includeScore:n})}_searchStringList(e){const s=Z(e,this.options),{records:r}=this._myIndex,n=[];return r.forEach(({v:i,i:o,n:l})=>{if(!w(i))return;const{isMatch:a,score:c,indices:h}=s.searchIn(i);a&&n.push({item:i,idx:o,matches:[{score:c,value:i,norm:l,indices:h}]})}),n}_searchLogical(e){const s=xe(e,this.options),r=(l,a,c)=>{if(!l.children){const{keyId:d,searcher:g}=l,p=this._findMatches({key:this._keyStore.get(d),value:this._myIndex.getValueForItemAtKeyId(a,d),searcher:g});return p&&p.length?[{idx:c,item:a,matches:p}]:[]}const h=[];for(let d=0,g=l.children.length;d<g;d+=1){const p=l.children[d],m=r(p,a,c);if(m.length)h.push(...m);else if(l.operator===V.AND)return[]}return h},n=this._myIndex.records,i={},o=[];return n.forEach(({$:l,i:a})=>{if(w(l)){let c=r(s,l,a);c.length&&(i[a]||(i[a]={idx:a,item:l,matches:[]},o.push(i[a])),c.forEach(({matches:h})=>{i[a].matches.push(...h)}))}}),o}_searchObjectList(e){const s=Z(e,this.options),{keys:r,records:n}=this._myIndex,i=[];return n.forEach(({$:o,i:l})=>{if(!w(o))return;let a=[];r.forEach((c,h)=>{a.push(...this._findMatches({key:c,value:o[h],searcher:s}))}),a.length&&i.push({idx:l,item:o,matches:a})}),i}_findMatches({key:e,value:s,searcher:r}){if(!w(s))return[];let n=[];if(S(s))s.forEach(({v:i,i:o,n:l})=>{if(!w(i))return;const{isMatch:a,score:c,indices:h}=r.searchIn(i);a&&n.push({score:c,key:e,value:i,idx:o,norm:l,indices:h})});else{const{v:i,n:o}=s,{isMatch:l,score:a,indices:c}=r.searchIn(i);l&&n.push({score:a,key:e,value:i,norm:o,indices:c})}return n}}D.version="7.0.0";D.createIndex=ye;D.parseIndex=it;D.config=u;D.parseQuery=xe;Mt(_t);const kt={data(){return{query:"",queryTimeout:0,queryResults:void 0,resultsShown:10,onlyConcerts:!1,sortTime:!1}},methods:{processQuery(){if(this.query.length<2){this.queryResults=[...this.$client.container.sortedEvents],this.sortTime&&this.sortQueryResultsAfterTime();return}const t=new D(this.$client.container.sortedEvents,{keys:["_cardTitle"],includeScore:!0});this.queryResults=[];for(let e of t.search(this.query))(e.score||0)>.5||this.queryResults.push(e.item);this.sortTime&&this.sortQueryResultsAfterTime()},sortQueryResultsAfterTime(){var e,s;let t=new Date().getTime()/1e3;this.queryResults=(e=this.queryResults)==null?void 0:e.filter(r=>r.end>t),(s=this.queryResults)==null||s.sort((r,n)=>r.start-n.start)},async showMore(){var t;this.resultsShown>(((t=this.queryResults)==null?void 0:t.length)||1/0)||(this.resultsShown=this.resultsShown+10,await ie(50),this.mountObserver())},async mountObserver(){for(;;){if(await ie(50),this.$refs["grid-end"]===void 0)continue;let t=this.$refs["grid-end"][0];new IntersectionObserver(s=>{s[0].isIntersecting&&this.showMore()}).observe(t);break}}},mounted(){this.processQuery(),this.mountObserver()},watch:{query(){clearTimeout(this.queryTimeout),this.queryTimeout=setTimeout(()=>{this.processQuery()},1e3)},sortTime(){this.processQuery()},"$refs.grid-end"(){console.log("chnges")}},components:{AppBar:Ie,BigEventCard:Be}},At={class:"responsive max"},Ct={class:"field large prefix round fill"},Tt=f("i",{class:"front"},"search",-1),Lt=["placeholder"],Rt=f("i",null,"headphones",-1),$t={class:"max"},Nt={class:"switch"},Ot=f("span",null,null,-1),Ft=f("i",null,"schedule",-1),Dt={class:"max"},jt={class:"switch"},Pt=f("span",null,null,-1),Bt={class:"grid"},zt={key:0,class:"s12 m6 l4"};function Kt(t,e,s,r,n,i){var a;const o=Y("AppBar"),l=Y("BigEventCard");return x(),M(N,null,[U(o,{label:"Acts"}),f("main",At,[f("div",Ct,[Tt,K(f("input",{class:"search",placeholder:t.$t("acts.search.placeholder"),"onUpdate:modelValue":e[0]||(e[0]=c=>n.query=c)},null,8,Lt),[[Se,n.query]])]),f("div",{class:"field prefix middle-align",onClick:e[3]||(e[3]=c=>n.onlyConcerts=!n.onlyConcerts)},[f("nav",null,[Rt,f("div",$t,[f("h6",null,O(t.$t("acts.filter.onlyConcerts.label")),1),f("div",null,O(t.$t("acts.filter.onlyConcerts.description")),1)]),f("label",Nt,[K(f("input",{type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=c=>n.onlyConcerts=c),onClick:e[2]||(e[2]=c=>n.onlyConcerts=!n.onlyConcerts)},null,512),[[oe,n.onlyConcerts]]),Ot])])]),f("div",{class:"field prefix middle-align",onClick:e[6]||(e[6]=c=>n.sortTime=!n.sortTime)},[f("nav",null,[Ft,f("div",Dt,[f("h6",null,O(t.$t("acts.filter.sortTime.label")),1),f("div",null,O(t.$t("acts.filter.sortTime.description")),1)]),f("label",jt,[K(f("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=c=>n.sortTime=c),onClick:e[5]||(e[5]=c=>n.sortTime=!n.sortTime)},null,512),[[oe,n.sortTime]]),Pt])])]),f("div",Bt,[(x(!0),M(N,null,Q((a=n.queryResults)==null?void 0:a.length,c=>(x(),M(N,null,[c<n.resultsShown?(x(),M(N,{key:0},[!n.onlyConcerts||n.queryResults[c-1].isConcert()?(x(),M("div",zt,[U(l,{event:n.queryResults[c-1]},null,8,["event"])])):F("",!0),c==n.resultsShown-4?(x(),M("span",{key:1,ref_for:!0,ref:"grid-end"},null,512)):F("",!0)],64)):F("",!0)],64))),256))])])],64)}const qt=de(kt,[["render",Kt]]);export{qt as default};
